<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <title>vue-lesson</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.0/dist/vue.js"></script>
  </head>
  <body class="d-flex justify-content-center">
    <div class="sample">
      <h2 v-show="todoItems.length == 0">Please add new task</h2>
      <h2 v-show="todoItems.length != 0"> {{ message }} </h2>
      
      

      <form class="input-group  mb-3" action="" v-on:submit.prevent="filterAll">
        <div class="input-group mb-3" >
          <input type="text" class="form-control" v-model.trim="todoItems.text" placeholder="Add new Task">
          <button v-bind:class="buttonSwitch" v-on:click="addTask"  class="btn" >Add</button> 
        </div>
          
      </form>

 <ul class="list-group mb-3 d-flex column">
        <li class="list-group-item " >
            Completed tasks {{ sum() }}  
        </li>
        <li class="list-group-item"  >
            All tasks {{ todoItems.length }}
        </li>
        
      </ul>
        <div>
              <progress-bar class="mb-3" v-bind:max="todoItems.length" v-bind:complete="sum()"  ></progress-bar>
        </div>
      <div class="btn-group mb-3" role="group" aria-label="Basic radio toggle button group">
        <input type="radio" class="btn-check" name="btnradio" id="btnradio1" v-on:click="filterAll" autocomplete="off" checked>
        <label class="btn btn-outline-primary" for="btnradio1">All Task</label>

        <input type="radio" class="btn-check" name="btnradio" id="btnradio2" v-on:click="filterTrue" autocomplete="off">
        <label class="btn btn-outline-primary" for="btnradio2">Comleted Task</label>

        <input type="radio" class="btn-check" name="btnradio" id="btnradio3" v-on:click="filterFalse" autocomplete="off">
        <label class="btn btn-outline-primary" for="btnradio3">Uncompleted Task</label>
      </div>

      
      
      <form class="input-group mb-3" action="" v-on:submit.prevent="filterTask">
        <div class="input-group mb-3" >
        <input placeholder="Search" class="form-control" type="text" v-model.trim="search" />
        <button class="btn btn-primary" >Search</button> 
        </div>
      </form>

      
            
      <ul class="list-group">
        <li class="list-group-item" v-for="item in arrayClone" >
            <button v-bind:class="{ 'btn-success':item.done == true, 'btn-secondary':item.done == false }" v-on:click="item.done = !item.done" class="btn" >{{ item.done ? "Completed" : "In order" }}</button>  {{ item.text }}
            
        </li>
      </ul>
      
    </div>
   

    <script type="application/javascript">
      Vue.component('progress-bar',{
        props: {
          max: Number,
          complete: Number,
        },
        computed: {
          progressCalc(){
            let width = this.complete / this.max * 100;
            
            return {
              width: width + '%'
            };
          }
        },
        template:`
          <div class="progress">
            <div class="progress-bar" v-bind:style="progressCalc"></div>
          </div>`
      })

      let sample = new Vue({
          el:'.sample',
        data: {
          
          'btn-basic': false,
          'btn-primary': true,
          search: '',
          i: 0,
          message: 'Hello from Vue App',
          todoItems: [],
          arrayClone: [],
        },

        methods: {
          doneTask (){
            this.arrayClone =  this.todoItems.filter((item) => item.done == true);
            return this.arrayClone.length;
          },

          addTask(){
              if(this.todoItems.text != undefined){
                this.todoItems.push({id: this.i, text: this.todoItems.text, done: false});
                this.i++;
                this.todoItems.text = undefined;
              } else {
                alert("Вы не ввели текст задачи");
              };
          },


          filterFalse(){ 
            this.arrayClone = this.todoItems.filter((item) => item.done == false);
            return this.arrayClone;
          },

          filterTrue(){
            this.arrayClone =  this.todoItems.filter((item) => item.done == true);
            return this.arrayClone;
          },

          filterAll(){
            this.arrayClone = this.todoItems.filter((item) => item.done == false || true);
            return this.arrayClone;
          },

           filterTask(){

            this.arrayClone = this.arrayClone.filter(item => {
            return item.text.toLowerCase().includes(this.search.toLowerCase())
          })
          },

          sum(){
            let sum = this.todoItems.filter((item) => item.done == true);
            return sum.length;
          },


        },

        computed: {

          
          buttonSwitch() {
            return {
              'btn-secondary': this.todoItems.text == undefined,
              'btn-primary': this.todoItems.text != undefined,
            }
          },

        
         
        },
      });
    </script>
  </body>
</html>
